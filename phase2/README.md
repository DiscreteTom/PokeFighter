# 第二阶段程序说明

在第一阶段的基础上，实现以下改进：
- 增加用户类
- 使用数据库存储信息
- 实现socket网络通信
- 完成服务端接口

## 设计

第一版本的设计是从小精灵类的实现入手的。第二版本不同，将从服务端接口的角度开始设计，并同时考虑数据库的引入

服务器在启动时将处于一个阻塞持续监听的状态，使用多线程技术实现按下任意键停止监听。所以在Server里面设置了两个线程函数listenFunc和terminateFunc，前者用于实现正常的阻塞监听，后者实现按键停止服务器。

针对多用户登录的问题，服务器设置一个统一的登录端口A0，这个端口将写死到客户端程序中。客户端向服务端的端口A0请求登录时，服务端程序将分配给客户用户一个目前未被使用的endpoint端口Ax，客户端将连接此Ax端口来实现持续的连接。

用户名和密码格式要求:
- 硬性要求
	- 没有换行符`\n`
	- 没有空字符`\0`
	- 长度大于6位
- 字符限制
	- 字母
	- 数字
	- 下划线`_`

数据库schema:

```sql
User(
	id integer primary key,
	name text unique not null,
	password text not null
);
```

其中设置User的id为integer类型的primary key的话，可以由sqlite3自动生成id